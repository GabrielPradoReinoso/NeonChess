<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>NEON CHESS</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" href="assets/images/logo-neon-chess.png" />
  </head>
  <body>
    <!-- Loading Screen -->
    <div id="loadingOverlay" class="loading-overlay">
      <div class="spinner"></div>
      <p>Cargando NEON CHESS‚Ä¶</p>
    </div>

    <!-- Cabecera -->
    <header class="header">
      <div class="logo">
        <a href="index.html">
          <img
            src="assets/images/logo-neon-chess.png"
            alt="Chess Logo"
            id="logo"
          />
        </a>
      </div>

      <div class="main-title">
        <h1>
          <a href="index.html">
            NEON
            <br class="mobile-only" />
            CHESS
          </a>
        </h1>
      </div>

      <div class="menu-dropdown">
        <button id="menuButton" class="menu-button">‚ò∞</button>

        <div id="dropdownMenu" class="dropdown-menu">
          <div class="menu-close">x</div>
          <ul>
            <a href="pagina-carga.html"><li>Ajustes</li></a>
            <a href="pagina-carga.html"><li>Tablero y piezas</li></a>
            <a href="pagina-carga.html"><li>Videos</li></a>
            <a href="pagina-carga.html"><li>Campeonatos</li></a>
            <a href="pagina-carga.html"><li>Sobre este proyecto</li></a>
          </ul>
        </div>
      </div>
    </header>

    <!-- Secci√≥n principal -->
    <main class="main-section" id="mainSection">
      <button id="btnLocal" class="btn">Jugar contra el robot</button>
      <br />
      <br />
      <button id="btnOnline" class="btn">Jugar online</button>
    </main>

    <!-- Panel elecci√≥n online -->
    <section id="onlineChoice" class="online-choice hidden">
      <h3>Juega online contra un amig@</h3>
      <p class="online-info">
        Uno de los jugadores debe generar el c√≥digo de la partida pulsando el
        bot√≥n <b class="marked-text">"Obtener c√≥digo"</b> y posteriormente
        compartir el c√≥digo con el amig@ que desea unirse, despu√©s este deber√°
        introducir el c√≥digo en el campo indicado y una vez introducido el
        c√≥digo correctamente en el campo, deber√° pulsar el bot√≥n de
        <b class="marked-text">"Unirse"</b> , automaticamente se conectar√° la
        partida y aparecera la p√°gina de juego y se podr√° comenzar a jugar.
        ¬°Buena suerte!
      </p>

      <div class="online-actions">
        <button id="btnCreateRoom" class="btn primary">Obtener c√≥digo</button>
        <p></p>
        <div class="join-box">
          <input
            id="joinCodeInput"
            type="text"
            placeholder="Introduce c√≥digo"
            maxlength="8"
          />
          <button id="btnJoinRoom" class="btn">Unirse</button>
        </div>
      </div>

      <div id="createdRoom" class="created-room hidden">
        <p>Comparte este c√≥digo con tu rival:</p>
        <div class="code-line">
          <code id="roomCodeText">‚Äî</code>
          <button id="copyRoomCode" class="btn small">Copiar</button>
        </div>
        <p class="muted">Esperando oponente‚Ä¶</p>
      </div>

      <button id="cancelOnlineChoice" class="btn ghost">Cancelar</button>
    </section>

    <div id="onlineLobby" class="hidden">
      <p>Tu c√≥digo de sala: <strong id="roomCode"></strong></p>
      <p>Esperando rival‚Ä¶</p>
    </div>

    <!-- Contenedor del juego (oculto al inicio) -->
    <div id="gameContainer" class="game-container hidden">
      <!-- Secci√≥n de configuraci√≥n de juego -->
      <div id="gameSetup" class="game-setup hidden">
        <h2 id="game-setup-title">ELIGE TU MODO DE JUEGO</h2>
        <div id="config-options">
          <!-- Dificultad -->
          <div class="plantilla-dos">
            <label for="difficultyButton">Nivel de dificultad</label>
            <div class="dropdown">
              <button id="difficultyButton" class="buttons">Nivel 1</button>
              <ul id="difficultyOptions" class="options hidden">
                <li data-level="1">Nivel 1</li>
                <li data-level="2">Nivel 2</li>
                <li data-level="3">Nivel 3</li>
                <li data-level="4">Nivel 4</li>
                <li data-level="5">Nivel 5</li>
                <li data-level="6">Nivel 6</li>
                <li data-level="7">Nivel 7</li>
                <li data-level="8">Nivel 8</li>
                <li data-level="9">Nivel 9</li>
                <li data-level="10">Nivel 10</li>
              </ul>
            </div>
          </div>

          <!-- Tiempo por jugador -->
          <div class="plantilla-dos">
            <label for="timeConfigButton">Tiempo por jugador</label>
            <div class="dropdown">
              <button id="timeConfigButton" class="buttons">‚àû</button>
              <ul id="timeOptions" class="options hidden">
                <li data-time="1">1 min</li>
                <li data-time="3">3 min</li>
                <li data-time="5">5 min</li>
                <li data-time="10">10 min</li>
                <li data-time="30">30 min</li>
                <li data-time="60">1 hora</li>
              </ul>
            </div>
          </div>

          <!-- Color de piezas -->
          <div class="plantilla-dos">
            <label for="colorButton">Color de tus piezas</label>
            <div class="dropdown">
              <button id="colorButton" class="buttons">Rosas</button>

              <ul id="colorOptions" class="options hidden">
                <li data-color="w" data-label="Rosas" id="pinkColor">
                  <img
                    src="assets/images/pink-neon-pawn.png"
                    alt="pink pawn (first player)"
                  />
                  <br />
                  Rosas
                  <br />
                  (mueven primero)
                </li>

                <li data-color="b" data-label="Azules" id="blueColor">
                  <img
                    src="assets/images/blue-neon-pawn.png"
                    alt="blue pawn (second player)"
                  />
                  <br />
                  Azules
                  <br />
                  (mueven despu√©s)
                </li>
              </ul>
            </div>
          </div>

          <!-- Bot√≥n empezar -->
          <button id="playButton" class="btn">Empezar partida</button>
        </div>
      </div>

      <!-- 0) HISTORIAL DE MOVIMIENTOS -->
      <div class="move-history-wrapper">
        <button id="undoBtn" class="history-btn back" aria-label="Retroceder">
          ‚óÄ
        </button>
        <div id="moveHistory" class="move-history"></div>
        <button id="redoBtn" class="history-btn next" aria-label="Avanzar">
          ‚ñ∂
        </button>
      </div>

      <div class="chess-container">
        <!-- Health (top / player1) -->
        <div
          class="health-bar health-bar-top"
          aria-label="Salud jugador superior"
        >
          <div class="health-progress" id="health-black"></div>
        </div>

        <div id="player1" class="player-profile top">
          <div class="matrix-overlay-player1"></div>

          <div class="profile-avatar">
            <img src="assets/images/gpr-robotic-img.jpg" alt="Jugador 1" />
          </div>

          <div class="profile-meta">
            <div class="profile-row profile-row--top">
              <span class="player-name">GPR robot</span>
              <span class="player-score">Puntos: 0</span>
              <span class="player-timer active-clock">00:00</span>
              <span class="turn-led" id="turnLedP1" title="Turno"></span>
              <span id="robotDifficulty" class="robot-diff"></span>
               <!-- Indicador conexi√≥n (solo oponente / online) -->
              <span id="connStatus" class="conn-status hidden offline" title="Conexi√≥n">
                <span class="conn-dot"></span>
                <span id="connText">Desconectado</span>
              </span>
            </div>
          </div>
        </div>

        <div id="chessBoard" class="chess-board">
          <!-- Las celdas se generan con JS -->
        </div>

        <div id="player2" class="player-profile bottom">
          <div class="profile-avatar">
            <img src="assets/images/human-img-profile.jpg" alt="Jugador 2" />
          </div>

          <div class="profile-meta">
            <div class="profile-row profile-row--top">
              <span class="player-name">Humano</span>
              <span class="player-score">Puntos: 0</span>
              <span class="player-timer active-clock">00:00</span>
              <span class="turn-led" id="turnLedP2" title="Turno"></span>
            </div>
          </div>
        </div>

        <!-- Health (bottom / player2) -->
        <div
          class="health-bar health-bar-bottom"
          aria-label="Salud jugador inferior"
        >
          <div class="health-progress" id="health-white"></div>
        </div>

        <div id="controlBar">
          <button id="btnPrev">
            <img
              src="assets/images/left-arrow.svg"
              alt="Retroceder movimientos"
            />
          </button>
          <button id="btnSurrender">
            <img src="assets/images/flag-button.png" alt="" />
          </button>
          <button id="btnNext">
            <img
              src="assets/images/right-arrow.svg"
              alt="Avance hacia adelante"
            />
          </button>

          <div id="musicPlayer" class="control-bar-item">
            <button id="prevTrack" title="Pista anterior">‚èÆÔ∏è</button>
            <button id="toggleMute" title="Silenciar/Activar sonido">üîä</button>
            <button id="nextTrack" title="Siguiente pista">‚è≠Ô∏è</button>
          </div>

          <button id="btnChat" title="Chat">üí¨</button>
        </div>
      </div>
    </div>

    <div id="chatModal" class="modal-overlay hidden">
      <div class="modal-box chat-modal">
        <button id="chatClose" class="modal-close-btn">√ó</button>
        <div id="chatMessages" class="chat-messages"></div>

        <form id="chatForm" class="chat-form">
          <input
            id="chatInput"
            maxlength="300"
            placeholder="Escribe..."
            autocomplete="off"
          />
          <button type="submit">Enviar</button>
        </form>
      </div>
    </div>

    <!-- Footer -->
    <footer>
      &copy; 2025 Gabriel Prado (GPR Studio). All rights reserved.
    </footer>

    <!-- Overlay de precarga pre-partida -->
    <div id="pregameLoadingOverlay" class="overlay hidden">
      <div class="overlay-content">
        <p>Cargando partida... <span id="pregamePercent">0%</span></p>
        <div class="progress-bar">
          <div id="pregameProgress" class="progress-fill"></div>
        </div>
      </div>
    </div>

    <!-- Overlay de cuenta regresiva -->
    <div id="countdownOverlay" class="overlay hidden">
      <div class="overlay-content">
        <div id="countdownNumber" class="countdown-number">3</div>
      </div>
    </div>

    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
    <!--<script src="http://localhost:8080/socket.io/socket.io.js"></script>-->
    <!--<script src="/socket.io/socket.io.js"></script>-->
    <script type="module" src="js/script.js"></script>
  </body>
</html>
